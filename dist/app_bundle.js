!function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function a(){if(firebase.auth().currentUser)firebase.auth().signOut(),A=null,U.innerHTML="",R.innerHTML="";else{var e=new firebase.auth.GoogleAuthProvider;e.addScope("https://www.googleapis.com/auth/contacts.readonly"),firebase.auth().signInWithPopup(e).then(function(e){e.credential.accessToken,e.user}).catch(function(e){var t=e.code;e.message,e.email,e.credential;"auth/account-exists-with-different-credential"===t?alert("You have already signed up with a different auth provider for that email."):console.error(e)})}}function i(){firebase.auth().onAuthStateChanged(function(e){if(document.getElementsByTagName("BODY")[0].classList.remove("loading"),e){var t=e.displayName,n=e.email;e.photoURL,e.uid,e.providerData;document.getElementById("signin-name").textContent=t,document.getElementById("signin-email").textContent=n,document.getElementsByTagName("BODY")[0].classList.remove("signed-out"),o()}else document.getElementsByTagName("BODY")[0].classList.add("signed-out")}),document.getElementById("google-sign-in").addEventListener("click",a,!1),document.getElementById("sign-out").addEventListener("click",a,!1)}function o(){document.getElementById("loading-spinner").classList.remove("hidden"),N.ref("/"+O+"/").once("value").then(function(e){document.getElementById("loading-spinner").classList.add("hidden"),A=e.val(),S=A.shift(),console.log(A),r(A.sort(B)),l(A.sort(I))},function(e){if(e.toString().indexOf("permission")!=-1)var t="Permission denied. You must use a @goodhumans.co.uk email.";else t="Yikes - couldn't connect to database.";document.getElementById("loading-spinner").innerHTML=t})}function s(e){if(!(e.target.value.length>=2)){var t=document.getElementsByClassName("list-heading");""!=e.target.value?Array.from(t).forEach(function(e){e.classList.add("hide")}):Array.from(t).forEach(function(e){e.classList.remove("hide")})}}function r(e){U.innerHTML=c(e);var t=document.getElementsByClassName("list-item");Array.from(t).forEach(function(e){e.addEventListener("click",u,!1)})}function c(e){var t=e.map(function(e,t,n){var a=JSON.parse(JSON.stringify(e));return t>=1?a.sameCategory=e.category==n[t-1].category:a.sameCategory=!1,a}),n={countryList:t},a='<div class="list-container">       <ul class="list">{{#countryList}}       {{^sameCategory}}<h3 class="list-heading"> {{category}} </h3> {{/sameCategory}}        <li class="list-item cat-{{category}}" id="{{code}}">           <span class="code-badge">{{code}}</span>           <span class="list-item-title">{{name}}</span>         </li>         {{/countryList}}       </ul>     </div>',i=Mustache.to_html(a,n);return i}function l(e){R.innerHTML=d(e);var t=document.getElementsByClassName("footer-item");Array.from(t).forEach(function(e){e.addEventListener("click",u,!1)})}function d(e){var t={countryList:e},n='<ul class="footer-list">{{#countryList}}       <li class="footer-item" id="{{code}}">         <span class="list-item-title">{{name}}</span>       </li>       {{/countryList}}     </ul>   </div>',a=Mustache.to_html(n,t);return a}function u(e){if(this)var t=this.id;else t="AL";var n=b("code",t),a=m(n);null==Y&&(Y=new tingle.modal({footer:!0,stickyFooter:!1,closeMethods:["overlay","button","escape"],closeLabel:"Close",cssClass:["country-modal"],beforeClose:function(){return!0}})),Y.setContent(a),Y.open(),p(n)}function m(e){var t=JSON.parse(JSON.stringify(e)),n={sections:[],name:t.name,code:t.code};if(delete t.name,delete t.code,delete t.category,"object"==C(t.images)){t.images=k(t.images),n.images=[];for(var a in t.images){var i={key:a,src:t.images[a]};n.images.push(i)}}else"string"==typeof t.images&&(n.images=[{key:0,src:t.images}]);for(var a in S){var o=S[a];if(t.hasOwnProperty(o)&&t[o].length>1&&"images"!=o){var s={};s.value=w(t[o]),s.key=o,n.sections.push(s)}}console.log(n);var r='<h3><span class="code-badge" id="country-code">{{code}}</span><span id="current-country">{{name}}</span></h3>   <div class="country-info">     {{#sections}}     <div class="section clearfix">       <dt class="section-title">{{key}} </dt>       <dd class="section-content">{{{value}}}</dd>     </div>     {{/sections}}   </div>   <div class="images" id="images-container" >     {{#images}} <div class="image-container">     <img src="{{src}}" alt="image for {{name}}" id="{{key}}" class="modal-image"> <span class="remove-cross">x<span></div> {{/images}}   </div>   <label class="custom-file-upload button" id="upload-container"><input type="file" id="file-upload" name="files[]" accept="image/x-png,image/gif,image/jpeg" />  Upload Image </label> <span id="upload-text"></span>',c=Mustache.to_html(r,n);return c}function g(){var e=document.getElementById("file-upload").files[0],t=document.getElementById("current-country").innerHTML,n=b("name",t),a=document.getElementById("upload-text"),i=O+"-"+t+"-"+e.name,o=H.ref(),s=o.child("images/"+i);s.getDownloadURL().then(function(e){n.images.includes(e)?a.innerHTML="File already exists in storage":f(e,t)}).catch(function(n){var i=s.put(e);i.on("state_changed",function(t){t.bytesTransferred/t.totalBytes*100;switch(a.innerHTML="Uploading file: "+e.name,t.state){case firebase.storage.TaskState.PAUSED:a.innerHTML="Upload is paused";break;case firebase.storage.TaskState.RUNNING:console.log("Upload is running")}},function(e){a.innerHTML="There was an error in the upload."},function(){a.innerHTML="";var e=i.snapshot.downloadURL;f(e,t)})})}function f(e,t){var n=b("name",t),a=A.findIndex(function(e){return e.name==t});a++,console.log("index: ",a),n.images=n.images||[],Array.isArray(n.images)||(n.images=[n.images]),console.log("images: ",n.images),n.images.push(e);var i=N.ref("/"+O+"/"+a);i.update(n).then(function(){E(a)});var o=m(n);Y.setContent(o),p(n)}function p(e){var t=document.getElementsByClassName("remove-cross");Array.from(t).forEach(function(e){e.addEventListener("click",y,!1)});var n=document.getElementsByClassName("modal-image");Array.from(n).forEach(function(e){e.addEventListener("error",x,!1)}),document.getElementById("file-upload").addEventListener("change",g),"object"==C(e.images)&&e.images.length>=2&&document.getElementById("upload-container").classList.add("hidden")}function y(e){var t=e.target.previousElementSibling.id,n=e.target.previousElementSibling.src,a=document.getElementById("country-code").innerHTML,i=b("code",a),o=A.findIndex(function(e){return e.code==a});o++,console.log(o);var s=H.refFromURL(n);s.delete().then(function(){i.images.splice(t,1);var e=N.ref("/"+O+"/"+o);e.update(i).then(function(){E(o)});var n=m(i);Y.setContent(n),p(i)}).catch(function(e){alert("Couldn't delete image, sorry.")})}function v(){r(A.sort(B)),U.classList.remove("list-view"),U.classList.add("grid-view"),D.classList.remove("active"),_.classList.add("active")}function h(){r(A.sort(I)),U.classList.add("list-view"),U.classList.remove("grid-view"),_.classList.remove("active"),D.classList.add("active")}function L(){}function E(e){console.log("cid: ",e," sheet: ",O),request("GET","https://script.google.com/macros/s/AKfycbzG2biCtXYdTxt5sLhfh1V5lE95V1ZhFVbkdcrR-Bua21zTihCa/exec?cid="+e+"&sheet="+O).done(function(e){console.log(e.getBody())})}function b(e,t){var n;return A.map(function(a){a[e]==t&&(n=a)}),n}function B(e,t){return e.category<t.category?-1:e.category>t.category?1:e.name<t.name?-1:e.name>t.name?1:0}function I(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function w(e){var t=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e.replace(t,"<a href='$1'>$1</a>")}function k(e){for(var t=new Array,n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}function T(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}function x(e){var t=e.target,n=document.getElementById("current-country").innerHTML,a=b("name",n),i=A.findIndex(function(e){return e.name==n});i++,a.images.splice(t.id,1);var o=N.ref("/"+O+"/"+i);o.update(a).then(function(){E(i)}),t.parentNode.outerHTML="",p(a)}var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M={apiKey:"AIzaSyA_0zTo845L0-w-tMfOb8Yp1kUKjQeQKIY",authDomain:"knowledge-database-87320.firebaseapp.com",databaseURL:"https://knowledge-database-87320.firebaseio.com",projectId:"knowledge-database-87320",storageBucket:"knowledge-database-87320.appspot.com"};firebase.initializeApp(M),window.onload=function(){i()};var A,S,N=firebase.database(),H=firebase.storage(),O=T("brand")||"monster";O=O.toLowerCase(),document.getElementById("logo-"+O).classList.add("active");var U=document.getElementById("main-list"),R=document.getElementById("footerData"),Y=null,_=document.getElementById("view-grid");_.addEventListener("click",v);var D=document.getElementById("view-list");D.addEventListener("click",h);var j=document.getElementById("sort-list");j.addEventListener("click",L);document.getElementById("main-edit"),document.getElementById("add-button");holmes({input:".searchbar",find:"ul.list li, ul.list h3",dynamic:!0}),document.getElementById("main-search").addEventListener("keyup",s)}]);